import{u as S,r as s,j as e,m as o}from"./vendor-BZYaQHyI.js";import{u as C,s as f}from"./index-Db7NAhvY.js";import{a as k}from"./utils-CsqPS4kC.js";import{H as U,r as E,I as A,O as q,h as I,x as z}from"./ui-DGJ538yy.js";function L(){const{user:v,updateProfile:b}=C(),g=S(),[n,w]=s.useState(""),[i,j]=s.useState(null),[c,N]=s.useState(null),[d,r]=s.useState(""),[m,u]=s.useState(!1),[x,h]=s.useState(null),y=l=>{const t=l.target.files[0];if(t){if(!t.type.startsWith("image/")){r("Please select a valid image file");return}if(t.size>5*1024*1024){r("Image size must be less than 5MB");return}j(t);const a=new FileReader;a.onloadend=()=>{N(a.result)},a.readAsDataURL(t),r("")}},P=async l=>{l.preventDefault(),u(!0),r("");try{if(!n.trim())throw new Error("Username is required");if(!i)throw new Error("Profile picture is required");const t=i.name.split(".").pop(),a=`${v.id}/avatar.${t}`,{error:p}=await f.storage.from("avatars").upload(a,i,{cacheControl:"3600",upsert:!0});if(p)throw console.error("Avatar upload error:",p),new Error("Failed to upload profile picture. Please try again.");const{data:{publicUrl:F}}=f.storage.from("avatars").getPublicUrl(a);await b({username:n.trim(),avatar_url:F}),k({particleCount:100,spread:70,origin:{y:.6},colors:["#ec4899","#f472b6","#fce7f3"]}),setTimeout(()=>{g("/onboarding")},500)}catch(t){console.error("Profile setup error:",t),r(t.message)}finally{u(!1)}};return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 relative overflow-hidden bg-gradient-to-br from-[#0f0505] via-[#1a0a0f] to-[#0f0505]",children:[e.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden -z-10 opacity-20",children:[e.jsx("div",{className:"absolute top-1/4 left-1/4 w-64 h-64 bg-love-600 rounded-full blur-[100px] animate-pulse"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-80 h-80 bg-purple-600 rounded-full blur-[120px]"})]}),e.jsxs(o.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"glass-panel rounded-3xl p-8 max-w-md w-full space-y-6 shadow-2xl border-white/10",children:[e.jsxs(o.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.1},className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"p-4 bg-love-500/10 rounded-2xl mb-2 ring-2 ring-love-400/20",children:e.jsx(U,{className:"w-12 h-12 text-love-500 fill-love-500/20"})}),e.jsx("h2",{className:"text-3xl font-bold",children:e.jsx("span",{className:"bg-gradient-to-r from-love-400 to-pink-400 bg-clip-text text-transparent",children:"Complete Your Profile"})}),e.jsx("p",{className:"text-white/60 text-sm text-center",children:"Let's personalize your account"})]}),d&&e.jsx(o.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},className:"p-4 bg-red-500/10 border border-red-500/30 text-red-200 text-sm rounded-xl",children:d}),e.jsxs("form",{onSubmit:P,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"username",className:"text-sm font-medium text-white/70 ml-1 block mb-2",children:["Username ",e.jsx("span",{className:"text-love-400",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(E,{className:`absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 transition-colors ${x==="username"?"text-love-400":"text-white/30"}`}),e.jsx("input",{id:"username",type:"text",required:!0,value:n,onChange:l=>w(l.target.value),onFocus:()=>h("username"),onBlur:()=>h(null),className:`w-full bg-black/20 border rounded-xl py-4 pl-12 pr-4 text-sm focus:outline-none transition-all ${x==="username"?"border-love-400 ring-2 ring-love-400/20":"border-white/10 hover:border-white/20"}`,placeholder:"your_username",maxLength:30})]}),e.jsx("p",{className:"text-xs text-white/40 mt-1 ml-1",children:"Choose a unique username"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium text-white/70 ml-1 block mb-2",children:["Profile Picture ",e.jsx("span",{className:"text-love-400",children:"*"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"relative",children:e.jsx("div",{className:"w-20 h-20 rounded-2xl bg-black/20 border-2 border-white/10 flex items-center justify-center overflow-hidden",children:c?e.jsx("img",{src:c,alt:"Profile preview",className:"w-full h-full object-cover"}):e.jsx(A,{className:"w-8 h-8 text-white/30"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{htmlFor:"avatar-upload",className:"cursor-pointer flex items-center justify-center gap-2 py-3 px-4 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl transition-all text-sm font-medium hover:border-love-400/30",children:[e.jsx(q,{className:"w-4 h-4"}),i?"Change Picture":"Upload Picture"]}),e.jsx("input",{id:"avatar-upload",type:"file",accept:"image/*",required:!0,onChange:y,className:"hidden"}),e.jsx("p",{className:"text-xs text-white/40 mt-1",children:"Max 5MB â€¢ JPG, PNG, GIF"})]})]})]}),e.jsx(o.button,{type:"submit",disabled:m,whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full py-4 bg-gradient-to-r from-love-600 to-pink-600 hover:from-love-500 hover:to-pink-500 text-white rounded-xl font-bold transition-all flex justify-center items-center gap-2 mt-6 shadow-lg shadow-love-500/30 disabled:opacity-70 disabled:cursor-not-allowed",children:m?e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-5 h-5 animate-spin"}),"Setting up..."]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-5 h-5"}),"Complete Profile"]})})]})]})]})}export{L as default};
